# AI-CHAT 환경 설정 파일
# 사용법: cp .env.example .env 후 값 수정

# ============================================================================
# 애플리케이션 설정
# ============================================================================
AI_CHAT_ENV=production  # development | staging | production
AI_CHAT_PORT=8501
AI_CHAT_HOST=0.0.0.0
AI_CHAT_VENV=.venv

# ============================================================================
# 검색 파라미터 (config.py 오버라이드)
# ============================================================================
# 벡터 검색 가중치 (0.0~1.0)
SEARCH_VECTOR_WEIGHT=0.2
# BM25 검색 가중치 (0.0~1.0)
SEARCH_BM25_WEIGHT=0.8
# 검색 결과 개수
SEARCH_TOP_K=5
# RRF K 값
SEARCH_RRF_K=20

# ============================================================================
# 재랭킹 파라미터
# ============================================================================
# 재랭킹 활성화 여부
RERANK_ENABLED=true
# 재랭킹 배치 크기
RERANK_BATCH_SIZE=32

# ============================================================================
# 컨텍스트 압축 파라미터
# ============================================================================
# 압축 비율 (0.0~1.0, 1.0 = 압축 안 함)
COMPRESS_RATIO=0.7
# 압축 활성화 여부
COMPRESS_ENABLED=true

# ============================================================================
# LLM 생성 파라미터
# ============================================================================
# 생성 온도 (0.0~1.0)
LLM_TEMPERATURE=0.1
# 최대 토큰 수
LLM_MAX_TOKENS=2048
# 모델 경로 (빈 값이면 기본값 사용)
LLM_MODEL_PATH=
# Chat format 설정
# auto: GGUF 메타데이터의 tokenizer.chat_template 자동 사용 (권장)
# 강제 지정: llama-2, chatml, qwen, zephyr 등
CHAT_FORMAT=auto

# ============================================================================
# 데이터베이스 설정
# ============================================================================
# 메타데이터 DB 경로
DB_METADATA_PATH=var/db/metadata.db
# Everything 인덱스 DB 경로
DB_EVERYTHING_PATH=var/db/everything_index.db
# DB busy timeout (ms)
DB_BUSY_TIMEOUT=5000
# WAL 모드 강제 활성화
DB_WAL_MODE=true

# ============================================================================
# 로깅 설정
# ============================================================================
# 로그 레벨 (DEBUG | INFO | WARNING | ERROR | CRITICAL)
LOG_LEVEL=INFO
# 로그 파일 경로
LOG_FILE=var/log/app.log
# 로그 로테이션 크기 (MB)
LOG_MAX_SIZE_MB=10
# 로그 백업 개수
LOG_BACKUP_COUNT=5

# ============================================================================
# 인덱스 경로
# ============================================================================
VECTOR_INDEX_PATH=rag_system/db/korean_vector_index.faiss
BM25_INDEX_PATH=rag_system/db/bm25_index.pkl

# ============================================================================
# 문서 경로
# ============================================================================
DOCS_DIR=docs

# ============================================================================
# 보안 설정
# ============================================================================
# Streamlit 비밀번호 (빈 값이면 비활성화)
STREAMLIT_PASSWORD=
# 허용된 IP 대역 (쉼표 구분, 빈 값이면 모두 허용)
ALLOWED_IPS=

# ============================================================================
# 백업 설정
# ============================================================================
# DB 백업 활성화
BACKUP_ENABLED=true
# DB 백업 경로
BACKUP_DIR=var/backups
# DB 백업 보관 기간 (일)
BACKUP_RETENTION_DAYS=7

# ============================================================================
# 메트릭/모니터링
# ============================================================================
# 메트릭 수집 활성화
METRICS_ENABLED=true
# 메트릭 파일 경로
METRICS_FILE=var/metrics.csv
# 슬로우 쿼리 임계값 (초)
SLOW_QUERY_THRESHOLD=3.0

# ============================================================================
# 개발/디버그 설정 (프로덕션에서는 false로 설정)
# ============================================================================
# 디버그 모드
DEBUG=false
# 상세 로깅
VERBOSE=false
# 모델 warmup 강제 실패 (테스트용)
FORCE_MODEL_FAIL=false

# ============================================================================
# 운용 모드 설정 - 일반 대화 vs 문서근거 자동 전환
# ============================================================================
# 운용 모드: AUTO (점수 기반 자동 전환) | SUMMARIZE (문서 요약 전용) | CHAT (일반 대화 전용)
MODE=AUTO
# 문서근거 모드 최소 점수 (0.0~1.0, 이하면 일반 대화 모드)
RAG_MIN_SCORE=0.35
# 문서근거 모드에서 사용할 상위 문서 개수
DOC_TOPK=3
# 출처 인용 필수 (true일 때 출처 누락 시 재시도)
REQUIRE_CITATIONS=true
# 일반 대화 허용 (false면 항상 문서근거만)
ALLOW_UNGROUNDED_CHAT=true

# 품질 가드
ENABLE_SCORE_GATING=true  # 점수 게이팅 (모든 문서 점수 미달 시 문서근거 차단)
ENABLE_HALLUCINATION_CHECK=true  # 환각 감지 (출처 없는 사실 주장 탐지)
LOG_QUERY_ANALYTICS=true  # 질의 분석 로깅 (mode/score/latency)
