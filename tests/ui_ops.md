# UI/UX 운영 테스트 체크리스트

**테스트 일시**: 2025-10-31
**테스트 환경**: WSL2, Python 3.12, RTX 4060
**백엔드**: FastAPI (port 7860)
**프론트엔드**: Streamlit (port 8501)

---

## 사전 준비

### 1. 서비스 상태 확인

```bash
# FastAPI 헬스체크
curl -s http://localhost:7860/_healthz
# Expected: {"status": "ok"}

# Streamlit 실행
streamlit run web_interface.py --server.port 8501 --server.headless true
```

**상태**: ⏳ 수동 확인 필요
**결과**:
- [ ] FastAPI 응답 OK
- [ ] Streamlit 정상 기동

---

## 테스트 케이스

### 1. 목록/페이지네이션

#### 1.1 기본 목록 (20개 제한)

**테스트 절차**:
1. 질의 입력: "최새름 문서 찾아줘"
2. 응답 결과 확인
3. 출처(evidence) 개수 확인

**예상 결과**:
- 최대 20개 문서 표시
- `display_limit=20` 적용 확인

**실제 결과**: ⏳ 수동 테스트 필요
**스크린샷**: `screenshots/pagination_basic.png`

**통과 여부**: ⬜

---

#### 1.2 전체 목록 ("전부/전체" 키워드)

**테스트 절차**:
1. 질의 입력: "최새름 문서 전부 보여줘"
2. 응답 결과 확인
3. 다른 키워드 테스트:
   - "최새름 문서 전체 보여줘"
   - "최새름 문서 모든 것 보여줘"
   - "최새름 문서 모두 보여줘"

**예상 결과**:
- 모든 매칭 문서 표시 (예: 134개)
- `display_limit` 무제한 적용
- Evidence(출처)도 동일하게 전체 표시

**실제 결과**: ⏳ 수동 테스트 필요
**스크린샷**: `screenshots/pagination_all.png`

**통과 여부**: ⬜

---

### 2. 미리보기 토글

#### 2.1 단일 파일 미리보기

**테스트 절차**:
1. 문서 목록에서 "🔎 미리보기" 버튼 클릭
2. 미리보기 창 표시 확인
3. 다시 버튼 클릭하여 닫기

**예상 결과**:
- 버튼 상태 변경: "🔎 미리보기" ↔ "📖 미리보는중"
- PDF 미리보기 정상 표시
- 토글 시 상태 유지

**실제 결과**: ⏳ 수동 테스트 필요
**스크린샷**: `screenshots/preview_single.png`

**통과 여부**: ⬜

---

#### 2.2 다중 파일 동시 미리보기

**테스트 절차**:
1. 첫 번째 문서 미리보기 열기
2. 두 번째 문서 미리보기 열기
3. 세 번째 문서 미리보기 열기
4. 각각 개별적으로 닫기

**예상 결과**:
- 각 파일의 토글 상태 독립적으로 유지
- `st.rerun()` 후에도 상태 유지
- 해시 기반 키 동작 정상

**실제 결과**: ⏳ 수동 테스트 필요
**스크린샷**: `screenshots/preview_multiple.png`

**통과 여부**: ⬜

---

### 3. doc_locked 동작

#### 3.1 특정 파일 지정 요약

**테스트 절차**:
1. 질의 입력: "2025-09-11_돌직구쇼_백업_무선마이크_구매_건.pdf 요약해줘"
2. 백엔드 로그 확인: `grep "doc_locked" logs/ai-chat.log`
3. 응답 출처 확인

**예상 결과**:
- 로그에 `doc_locked=True` 표시
- 해당 문서의 청크만 사용
- 다른 문서 청크 미포함

**실제 결과**: ⏳ 수동 테스트 필요
**로그 출력**:
```
[검증 필요] grep "doc_locked" logs/ai-chat.log
```

**통과 여부**: ⬜

---

### 4. 키워드 라우팅

#### 4.1 SUMMARY 모드 트리거

**테스트 절차**:
1. 질의 입력 (각각 테스트):
   - "검토서 요약해줘"
   - "기안서 요약해줘"
   - "최새름 작성 문서 요약해줘"

**예상 결과**:
- 응답 모드: `SUMMARY`
- 구조화된 JSON 응답
- 필수 필드: title, drafter, date, main_content

**실제 결과**: ⏳ 수동 테스트 필요
**스크린샷**: `screenshots/mode_summary.png`

**통과 여부**: ⬜

---

#### 4.2 QA 모드 + 인용 보장

**테스트 절차**:
1. 질의 입력: "EX-3 관련 문서 찾아줘"
2. has_code=True 확인
3. 인용(sources) 존재 확인

**예상 결과**:
- 응답 모드: `QA`
- has_code: `True`
- 출처 인용 보장 (Citation Rate = 1.0)

**실제 결과**: ⏳ 수동 테스트 필요
**스크린샷**: `screenshots/mode_qa_code.png`

**통과 여부**: ⬜

---

### 5. 오류 처리

#### 5.1 삭제된 파일 처리

**테스트 절차**:
1. 임시로 파일 이동: `mv docs/year_2025/test.pdf /tmp/`
2. 해당 파일 미리보기 시도
3. 오류 메시지 확인

**예상 결과**:
- 사용자 친화적 오류 메시지 표시
- "파일을 찾을 수 없습니다" 등의 가이드 문구
- 애플리케이션 크래시 없음

**실제 결과**: ⏳ 수동 테스트 필요
**스크린샷**: `screenshots/error_missing_file.png`

**통과 여부**: ⬜

---

#### 5.2 JSON 파싱 실패 폴백

**테스트 절차**:
1. 복잡한 질의로 JSON 파싱 실패 유도
2. 응답 형식 확인
3. 배너 메시지 확인

**예상 결과**:
- 자유 형식 요약으로 폴백
- "구조화된 형식 생성 실패, 자유 요약으로 제공합니다" 배너 표시
- 응답 내용은 여전히 유용함

**실제 결과**: ⏳ 수동 테스트 필요
**스크린샷**: `screenshots/error_json_fallback.png`

**통과 여부**: ⬜

---

### 6. 재색인 상호배제

#### 6.1 Mutex 동작 확인

**테스트 절차**:
1. 자동 인덱서 동작 중 확인: `ls -la var/reindexing.lock`
2. UI에서 Drop&Rebuild 시도
3. 상호배제 메시지 확인

**예상 결과**:
- `var/reindexing.lock` 존재 시 재색인 거부
- 사용자 메시지: "재색인이 이미 진행 중입니다"
- 크래시 없음

**실제 결과**: ⏳ 수동 테스트 필요
**로그 출력**:
```
[검증 필요] Lock 파일 상태 및 UI 응답
```

**통과 여부**: ⬜

---

#### 6.2 /metrics 갱신 확인

**테스트 절차**:
1. 재색인 완료 후 `/metrics` 확인
2. 지표 값 검증

```bash
curl -s http://localhost:7860/metrics | jq '.'
```

**예상 결과**:
```json
{
  "stale_index_entries": 0,
  "last_full_reindex_ts": "2025-10-31T...",
  "fs_file_count": 488,
  "index_file_count": 488
}
```

**실제 결과**: ⏳ 수동 테스트 필요

**통과 여부**: ⬜

---

### 7. 접근성 (선택사항)

#### 7.1 키보드 내비게이션

**테스트 절차**:
1. Tab 키로 순회
2. 이동 순서 확인: 입력창 → 목록 → 버튼 → 미리보기

**예상 결과**:
- 논리적인 Tab 순서
- 포커스 표시 명확
- Enter 키로 버튼 활성화 가능

**실제 결과**: ⏳ 수동 테스트 필요

**통과 여부**: ⬜ (선택)

---

## 성능 지표

### /metrics 응답 시간

```bash
time curl -s http://localhost:7860/metrics > /dev/null
```

**목표**: < 50ms
**실제**: ⏳ 측정 필요
**통과 여부**: ⬜

---

### 핵심 지표 확인

```bash
curl -s http://localhost:7860/metrics | jq '{
  stale_index_entries,
  fs_file_count,
  index_file_count,
  last_full_reindex_ts
}'
```

**예상**:
- `stale_index_entries`: 0
- `fs_file_count` ≈ `index_file_count`

**실제**: ⏳ 확인 필요
**통과 여부**: ⬜

---

## 요약

### 테스트 결과 집계

| 카테고리 | 항목 | 통과 | 실패 | 미실행 |
|---------|------|------|------|--------|
| 페이지네이션 | 2 | 0 | 0 | 2 |
| 미리보기 | 2 | 0 | 0 | 2 |
| doc_locked | 1 | 0 | 0 | 1 |
| 키워드 라우팅 | 2 | 0 | 0 | 2 |
| 오류 처리 | 2 | 0 | 0 | 2 |
| 재색인 | 2 | 0 | 0 | 2 |
| 접근성 | 1 | 0 | 0 | 1 |
| **총계** | **12** | **0** | **0** | **12** |

### 발견된 이슈

⏳ 수동 테스트 후 기록

---

## 승인 기준 (AC)

- [ ] 체크리스트 100% 통과 (12/12)
- [ ] /metrics 응답 시간 < 50ms
- [ ] stale_index_entries = 0
- [ ] 크리티컬 이슈 0건

---

## 테스트 수행자

**이름**: _______________
**일시**: _______________
**서명**: _______________

---

## 비고

이 문서는 수동 테스트를 위한 체크리스트입니다. 실제 테스트 수행 시:
1. 각 항목을 순서대로 실행
2. 스크린샷 캡처 (`screenshots/` 디렉토리)
3. 로그 출력 첨부
4. 발견된 이슈는 "발견된 이슈" 섹션에 기록
5. 모든 항목 완료 후 승인 기준 체크

**생성 일시**: 2025-10-31
**최종 수정**: 2025-10-31
